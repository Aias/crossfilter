!function(r){function n(r){return r}function t(r,n,t){for(var e=0,i=n.length,o=t?JSON.parse(JSON.stringify(r)):Array(i);i>e;++e)o[e]=r[n[e]];return o}function e(r){function n(n,t,e,i){for(;i>e;){var o=e+i>>>1;r(n[o])<t?e=o+1:i=o}return e}function t(n,t,e,i){for(;i>e;){var o=e+i>>>1;t<r(n[o])?i=o:e=o+1}return e}return t.right=t,t.left=n,t}function o(r){function n(r,n,t){for(var i=t-n,o=(i>>>1)+1;--o>0;)e(r,o,i,n);return r}function t(r,n,t){for(var i,o=t-n;--o>0;)i=r[n],r[n]=r[n+o],r[n+o]=i,e(r,1,o,n);return r}function e(n,t,e,i){for(var o,u=n[--i+t],f=r(u);(o=t<<1)<=e&&(e>o&&r(n[i+o])>r(n[i+o+1])&&o++,!(f<=r(n[i+o])));)n[i+t]=n[i+o],t=o;n[i+t]=u}return n.sort=t,n}function u(r){function n(n,e,i,o){var u,f,a,l,s=Array(o=Math.min(i-e,o));for(f=0;o>f;++f)s[f]=n[e++];if(t(s,0,o),i>e){u=r(s[0]);do(a=r(l=n[e])>u)&&(s[0]=l,u=r(t(s,0,o)[0]));while(++e<i)}return s}var t=o(r);return n}function f(r){function n(n,t,e){for(var i=t+1;e>i;++i){for(var o=i,u=n[i],f=r(u);o>t&&r(n[o-1])>f;--o)n[o]=n[o-1];n[o]=u}return n}return n}function a(r){function n(r,n,i){return(F>i-n?e:t)(r,n,i)}function t(t,e,i){var o,u=0|(i-e)/6,f=e+u,a=i-1-u,l=e+i-1>>1,s=l-u,h=l+u,c=t[f],v=r(c),p=t[s],g=r(p),d=t[l],y=r(d),b=t[h],x=r(b),k=t[a],m=r(k);v>g&&(o=c,c=p,p=o,o=v,v=g,g=o),x>m&&(o=b,b=k,k=o,o=x,x=m,m=o),v>y&&(o=c,c=d,d=o,o=v,v=y,y=o),g>y&&(o=p,p=d,d=o,o=g,g=y,y=o),v>x&&(o=c,c=b,b=o,o=v,v=x,x=o),y>x&&(o=d,d=b,b=o,o=y,y=x,x=o),g>m&&(o=p,p=k,k=o,o=g,g=m,m=o),g>y&&(o=p,p=d,d=o,o=g,g=y,y=o),x>m&&(o=b,b=k,k=o,o=x,x=m,m=o);var z=p,E=g,A=b,w=x;t[f]=c,t[s]=t[e],t[l]=d,t[h]=t[i-1],t[a]=k;var O=e+1,_=i-2,M=w>=E&&E>=w;if(M)for(var N=O;_>=N;++N){var C=t[N],S=r(C);if(E>S)N!==O&&(t[N]=t[O],t[O]=C),++O;else if(S>E)for(;;){var U=r(t[_]);{if(!(U>E)){if(E>U){t[N]=t[O],t[O++]=t[_],t[_--]=C;break}t[N]=t[_],t[_--]=C;break}_--}}}else for(var N=O;_>=N;N++){var C=t[N],S=r(C);if(E>S)N!==O&&(t[N]=t[O],t[O]=C),++O;else if(S>w)for(;;){var U=r(t[_]);{if(!(U>w)){E>U?(t[N]=t[O],t[O++]=t[_],t[_--]=C):(t[N]=t[_],t[_--]=C);break}if(_--,N>_)break}}}if(t[e]=t[O-1],t[O-1]=z,t[i-1]=t[_+1],t[_+1]=A,n(t,e,O-1),n(t,_+2,i),M)return t;if(f>O&&_>a){for(var F,U;(F=r(t[O]))<=E&&F>=E;)++O;for(;(U=r(t[_]))<=w&&U>=w;)--_;for(var N=O;_>=N;N++){var C=t[N],S=r(C);if(E>=S&&S>=E)N!==O&&(t[N]=t[O],t[O]=C),O++;else if(w>=S&&S>=w)for(;;){var U=r(t[_]);{if(!(w>=U&&U>=w)){E>U?(t[N]=t[O],t[O++]=t[_],t[_--]=C):(t[N]=t[_],t[_--]=C);break}if(_--,N>_)break}}}}return n(t,O,_+1)}var e=f(r);return n}function s(r){for(var n=Array(r),t=-1;++t<r;)n[t]=0;return n}function h(r,n){for(var t=r.length;n>t;)r[t++]=0;return r}function c(r,n){if(n>32)throw Error("invalid array width!");return r}function v(r){this.length=r,this.subarrays=1,this.width=8,this.masks={0:0},this[0]=J(r)}function p(r,n){return function(t){var e=t.length;return[r.left(t,n,0,e),r.right(t,n,0,e)]}}function g(r,n){var t=n[0],e=n[1];return function(n){var i=n.length;return[r.left(n,t,0,i),r.left(n,e,0,i)]}}function d(r){return[0,r.length]}function y(){return null}function b(){return 0}function x(r){return r+1}function m(r){return r-1}function z(r){return function(n,t){return n+ +r(t)}}function E(r){return function(n,t){return n-r(t)}}function A(){function r(r){var n=J,t=r.length;return t&&(F=F.concat(r),S.lengthen(J+=t),q.forEach(function(e){e(r,n,t)}),C("dataAdded")),U}function e(){for(var r=w(J,J),n=[],t=0,e=0;J>t;++t)S.zero(t)?n.push(t):r[t]=e++;R.forEach(function(r){r(-1,-1,[],n,!0)}),D.forEach(function(n){n(r)});for(var t=0,e=0;J>t;++t)S.zero(t)||(t!==e&&(S.copy(e,t),F[e]=F[t]),++e);F.length=J=e,S.truncate(e),C("dataRemoved")}function f(r,n){var t,e,i,o=Array(S.subarrays);for(t=0;t<S.subarrays;t++)o[t]=-1;if(n)for(e=0;e<n.length;e++)i=n[e],o[i._offset]&=i._zero;for(t=0;t<S.subarrays;t++)if(S[t][r]&o[t])return!1;return!0}function s(r,e){function f(n,o,u){if(e){for(yn=0,p=0,k=[],i=0;i<n.length;i++)for(p=0,k=r(n[i]);p<k.length;p++)yn++;rn=[],en=O(n.length),un=w(yn,1),an=[];var f=O(yn);for(l=0,i=0;i<n.length;i++)if(k=r(n[i]),k.length)for(en[i]=k.length,p=0;p<k.length;p++)rn.push(k[p]),f[l]=i,l++;else en[i]=0,an.push(i);var a=hn(O(yn),0,yn);rn=t(rn,a),nn=t(f,a)}else rn=n.map(r),nn=hn(O(u),0,u),rn=t(rn,nn);e&&(u=yn);var s=cn(rn),h=s[0],c=s[1];if(ln)for(i=0;u>i;++i)ln(rn[i],i)||(S[W][nn[i]+o]|=T,e&&(un[i]=1));else{for(i=0;h>i;++i)S[W][nn[i]+o]|=T,e&&(un[i]=1);for(i=c;u>i;++i)S[W][nn[i]+o]|=T,e&&(un[i]=1)}if(!o)return X=rn,Y=nn,tn=en,on=un,gn=h,dn=c,void 0;if(Z=X,$=Y,fn=on,i0=0,i1=0,e&&(old_n0=o,o=Z.length,u=yn),X=e?Array(o+u):Array(J),Y=e?Array(o+u):w(J,J),e&&(on=w(o+u,1)),e){var v=tn.length;tn=j(tn,J);for(var p=0;J>p+v;p++)tn[p+v]=en[p]}for(i=0;o>i0&&u>i1;++i)Z[i0]<rn[i1]?(X[i]=Z[i0],e&&(on[i]=fn[i0]),Y[i]=$[i0++]):(X[i]=rn[i1],e&&(on[i]=fn[i1]),Y[i]=nn[i1++]+(e?old_n0:o));for(;o>i0;++i0,++i)X[i]=Z[i0],e&&(on[i]=fn[i0]),Y[i]=$[i0];for(;u>i1;++i1,++i)X[i]=rn[i1],e&&(on[i]=fn[i1]),Y[i]=nn[i1]+(e?old_n0:o);s=cn(X),gn=s[0],dn=s[1]}function s(r,n,t){vn.forEach(function(r){r(rn,nn,n,t)}),rn=nn=null}function h(r){for(var n,t=0,e=0;J>t;++t)S.zero(n=Y[t])||(t!==e&&(X[e]=X[t]),Y[e]=r[n],++e);for(X.length=e;J>e;)Y[e++]=0;var i=cn(X);gn=i[0],dn=i[1]}function c(r){var n=r[0],t=r[1];if(ln)return ln=null,H(function(r,e){return e>=n&&t>e},0===r[0]&&r[1]===Y.length),gn=n,dn=t,sn;var i,o,u,f=[],a=[],l=[],s=[];if(gn>n)for(i=n,o=Math.min(gn,t);o>i;++i)f.push(Y[i]),l.push(i);else if(n>gn)for(i=gn,o=Math.min(n,dn);o>i;++i)a.push(Y[i]),s.push(i);if(t>dn)for(i=Math.max(n,dn),o=t;o>i;++i)f.push(Y[i]),l.push(i);else if(dn>t)for(i=Math.max(gn,t),o=dn;o>i;++i)a.push(Y[i]),s.push(i);if(e){var h=[],c=[];for(i=0;i<f.length;i++)tn[f[i]]++,on[l[i]]=0,1===tn[f[i]]&&(S[W][f[i]]^=T,h.push(f[i]));for(i=0;i<a.length;i++)tn[a[i]]--,on[s[i]]=1,0===tn[a[i]]&&(S[W][a[i]]^=T,c.push(a[i]));if(f=h,a=c,0===r[0]&&r[1]===Y.length)for(i=0;i<an.length;i++)S[W][u=an[i]]&T&&(S[W][u]^=T,f.push(u));else for(i=0;i<an.length;i++)S[W][u=an[i]]&T||(S[W][u]^=T,a.push(u))}else{for(i=0;i<f.length;i++)S[W][f[i]]^=T;for(i=0;i<a.length;i++)S[W][a[i]]^=T}return gn=n,dn=t,R.forEach(function(r){r(T,W,f,a)}),C("filtered"),sn}function v(r){return null==r?U():Array.isArray(r)?N(r):"function"==typeof r?G(r):A(r)}function A(r){return c((cn=p(M,r))(X))}function N(r){return c((cn=g(M,r))(X))}function U(){return c((cn=d)(X))}function G(r){return cn=d,H(ln=r,!1),gn=0,dn=J,sn}function H(r,n){var t,i,o,u=[],f=[],a=[],l=[],s=Y.length;if(!e)for(t=0;s>t;++t)!(S[W][i=Y[t]]&T)^!!(o=r(X[t],t))&&(o?u.push(i):f.push(i));if(e)for(t=0;s>t;++t)r(X[t],t)?(u.push(Y[t]),a.push(t)):(f.push(Y[t]),l.push(t));if(e){var h=[],c=[];for(t=0;t<u.length;t++)1===on[a[t]]&&(tn[u[t]]++,on[a[t]]=0,1===tn[u[t]]&&(S[W][u[t]]^=T,h.push(u[t])));for(t=0;t<f.length;t++)0===on[l[t]]&&(tn[f[t]]--,on[l[t]]=1,0===tn[f[t]]&&(S[W][f[t]]^=T,c.push(f[t])));if(u=h,f=c,n)for(t=0;t<an.length;t++)S[W][i=an[t]]&T&&(S[W][i]^=T,u.push(i));else for(t=0;t<an.length;t++)S[W][i=an[t]]&T||(S[W][i]^=T,f.push(i))}else{for(t=0;t<u.length;t++)S[W][u[t]]&T&&(S[W][u[t]]&=V);for(t=0;t<f.length;t++)S[W][f[t]]&T||(S[W][f[t]]|=T)}R.forEach(function(r){r(T,W,u,f)}),C("filtered")}function I(r){for(var n,t=[],i=dn;--i>=gn&&r>0;)S.zero(n=Y[i])&&(t.push(F[n]),--r);if(e)for(i=0;i<an.length&&r>0;i++)S.zero(n=an[i])&&(t.push(F[n]),--r);return t}function K(r){var n,t,i=[];if(e)for(n=0;n<an.length&&r>0;n++)S.zero(t=an[n])&&(i.push(F[t]),--r);for(n=gn;dn>n&&r>0;)S.zero(t=Y[n])&&(i.push(F[t]),--r),n++;return i}function L(r){function f(n,o,u,f){function a(){return e?(Z++,void 0):(++Z===Q&&(m=B(m,P<<=1),q=B(q,P),Q=_(P)),void 0)}e&&(n0old=u,u=X.length-n.length,f=n.length);var v,p,g,d,b,x,k=U,m=e?[]:w(Z,Q),z=I,E=K,A=L,O=Z,M=0,N=0;for(nn&&(z=A=y),nn&&(E=A=y),U=Array(Z),Z=0,q=e?O>1?q:[]:O>1?j(q,J):w(J,Q),O&&(g=(p=k[0]).key);f>N&&!((d=r(n[N]))>=d);)++N;for(;f>N;){for(p&&d>=g?(b=p,x=g,m[M]=Z,(p=k[++M])&&(g=p.key)):(b={key:d,value:A()},x=d),U[Z]=b;x>=d&&(v=o[N]+(e?n0old:u),e?q[v]?q[v].push(Z):q[v]=[Z]:q[v]=Z,b.value=z(b.value,F[v],!0),S.zeroExcept(v,W,V)||(b.value=E(b.value,F[v],!1)),!(++N>=f));)d=r(n[N]);a()}for(;O>M;)U[m[M]=Z]=k[M++],a();if(e)for(i=0;J>i;i++)q[i]||(q[i]=[]);if(Z>M)if(e)q=t(q,m,!0);else for(M=0;u>M;++M)q[M]=m[q[M]];v=R.indexOf($),Z>1?($=l,rn=h):(!Z&&tn&&(Z=1,U=[{key:null,value:A()}]),1===Z?($=s,rn=c):($=y,rn=y),q=null),R[v]=$}function a(){if(Z>1){for(var r=Z,n=U,t=w(r,r),e=0,i=0;J>e;++e)S.zero(e)||(t[q[i]=q[e]]=1,++i);for(U=[],Z=0,e=0;r>e;++e)t[e]&&(t[e]=Z++,U.push(n[e]));if(Z>1)for(var e=0;i>e;++e)q[e]=t[q[e]];else q=null;R[R.indexOf($)]=Z>1?(rn=h,$=l):1===Z?(rn=c,$=s):rn=$=y}else if(1===Z){if(tn)return;for(var e=0;J>e;++e)if(!S.zero(e))return;U=[],Z=0,R[R.indexOf($)]=$=rn=y}}function l(r,n,t,i,o){if(!(r===T&&n===W||nn)){var u,f,a,l,s;if(e){for(u=0,l=t.length;l>u;++u)if(S.zeroExcept(a=t[u],W,V))for(f=0;f<q[a].length;f++)s=U[q[a][f]],s.value=I(s.value,F[a],!1,f);for(u=0,l=i.length;l>u;++u)if(S.onlyExcept(a=i[u],W,V,n,r))for(f=0;f<q[a].length;f++)s=U[q[a][f]],s.value=K(s.value,F[a],o,f)}else{for(u=0,l=t.length;l>u;++u)S.zeroExcept(a=t[u],W,V)&&(s=U[q[a]],s.value=I(s.value,F[a],!1));for(u=0,l=i.length;l>u;++u)S.onlyExcept(a=i[u],W,V,n,r)&&(s=U[q[a]],s.value=K(s.value,F[a],o))}}}function s(r,n,t,e,i){if(!(r===T&&n===W||nn)){var o,u,f,a=U[0];for(o=0,f=t.length;f>o;++o)S.zeroExcept(u=t[o],W,V)&&(a.value=I(a.value,F[u],!1));for(o=0,f=e.length;f>o;++o)S.onlyExcept(u=e[o],W,V,n,r)&&(a.value=K(a.value,F[u],i))}}function h(){var r,n,t;for(r=0;Z>r;++r)U[r].value=L();if(e){for(r=0;J>r;++r)for(n=0;n<q[r].length;n++)t=U[q[r][n]],t.value=I(t.value,F[r],!0,n);for(r=0;J>r;++r)if(!S.zeroExcept(r,W,V))for(n=0;n<q[r].length;n++)t=U[q[r][n]],t.value=K(t.value,F[r],!1,n)}else{for(r=0;J>r;++r)t=U[q[r]],t.value=I(t.value,F[r],!0);for(r=0;J>r;++r)S.zeroExcept(r,W,V)||(t=U[q[r]],t.value=K(t.value,F[r],!1))}}function c(){var r,n=U[0];for(n.value=L(),r=0;J>r;++r)n.value=I(n.value,F[r],!0);for(r=0;J>r;++r)S.zeroExcept(r,W,V)||(n.value=K(n.value,F[r],!1))}function v(){return nn&&(rn(),nn=!1),U}function p(r){var n=G(v(),0,U.length,r);return H.sort(n,0,n.length)}function g(r,n,t){return I=r,K=n,L=t,nn=!0,C}function d(){return g(x,m,b)}function k(r){return g(z(r),E(r),b)}function A(r){function n(n){return r(n.value)}return G=u(n),H=o(n),C}function O(){return A(n)}function M(){return Z}function N(){var r=R.indexOf($);return r>=0&&R.splice(r,1),r=vn.indexOf(f),r>=0&&vn.splice(r,1),r=D.indexOf(a),r>=0&&D.splice(r,1),C}var C={top:p,all:v,reduce:g,reduceCount:d,reduceSum:k,order:A,orderNatural:O,size:M,dispose:N,remove:N};pn.push(C);var U,q,G,H,I,K,L,P=8,Q=_(P),Z=0,$=y,rn=y,nn=!0,tn=r===y;return arguments.length<1&&(r=n),R.push($),vn.push(f),D.push(a),f(X,Y,0,J),d().orderNatural()}function P(){var r=L(y),n=r.all;return delete r.all,delete r.top,delete r.order,delete r.orderNatural,delete r.size,r.value=function(){return n()[0].value},r}function Q(){pn.forEach(function(r){r.dispose()});var r=q.indexOf(f);return r>=0&&q.splice(r,1),r=q.indexOf(s),r>=0&&q.splice(r,1),r=D.indexOf(h),r>=0&&D.splice(r,1),S.masks[W]&=V,U()}var T,V,W,X,Y,Z,$,rn,nn,tn,en,on,un,fn,an,ln,sn={filter:v,filterExact:A,filterRange:N,filterFunction:G,filterAll:U,top:I,bottom:K,group:L,groupAll:P,dispose:Q,remove:Q},hn=a(function(r){return rn[r]}),cn=d,vn=[],pn=[],gn=0,dn=0,yn=0;q.unshift(f),q.push(s),D.push(h);var bn=S.add();return W=bn.offset,T=bn.one,V=~T,sn._offset=W,sn._one=T,sn._zero=V,f(F,0,J),s(F,0,J),sn}function h(){function r(r,n){var t;if(!v)for(t=n;J>t;++t)a=l(a,F[t],!0),S.zero(t)||(a=s(a,F[t],!1))}function n(r,n,t,e,i){var o,u,f;if(!v){for(o=0,f=t.length;f>o;++o)S.zero(u=t[o])&&(a=l(a,F[u],i));for(o=0,f=e.length;f>o;++o)S.only(u=e[o],n,r)&&(a=s(a,F[u],i))}}function t(){var r;for(a=h(),r=0;J>r;++r)a=l(a,F[r],!0),S.zero(r)||(a=s(a,F[r],!1))}function e(r,n,t){return l=r,s=n,h=t,v=!0,c}function i(){return e(x,m,b)}function o(r){return e(z(r),E(r),b)}function u(){return v&&(t(),v=!1),a}function f(){var t=R.indexOf(n);return t>=0&&R.splice(t),t=q.indexOf(r),t>=0&&q.splice(t),c}var a,l,s,h,c={reduce:e,reduceCount:i,reduceSum:o,value:u,dispose:f,remove:f},v=!0;return R.push(n),q.push(r),r(F,0,J),i()}function c(){return J}function A(){return F}function N(r){return"function"!=typeof r?(console.warn("onChange callback parameter must be a function!"),void 0):(G.push(r),function(){G.splice(G.indexOf(r),1)})}function C(r){for(var n=0;n<G.length;n++)G[n](r)}var S,U={add:r,remove:e,dimension:s,groupAll:h,size:c,all:A,onChange:N,isElementFiltered:f},F=[],J=0,R=[],q=[],D=[],G=[];return S=new v(0),arguments.length?r(arguments[0]):U}function w(r,n){return(257>n?J:65537>n?R:q)(r)}function O(r){for(var n=w(r,r),t=-1;++t<r;)n[t]=t;return n}function _(r){return 8===r?256:16===r?65536:4294967296}A.version="1.4.0-alpha.01",A.permute=t;var M=A.bisect=e(n);M.by=e;var N=A.heap=o(n);N.by=o;var C=A.heapselect=u(n);C.by=u;var S=A.insertionsort=f(n);S.by=f;var U=A.quicksort=a(n);U.by=a;var F=32,J=s,R=s,q=s,j=h,B=c;"undefined"!=typeof Uint8Array&&(J=function(r){return new Uint8Array(r)},R=function(r){return new Uint16Array(r)},q=function(r){return new Uint32Array(r)},j=function(r,n){if(r.length>=n)return r;var t=new r.constructor(n);return t.set(r),t},B=function(r,n){var t;switch(n){case 16:t=R(r.length);break;case 32:t=q(r.length);break;default:throw Error("invalid array width!")}return t.set(r),t}),v.prototype.lengthen=function(r){var n,t;for(n=0,t=this.subarrays;t>n;++n)this[n]=j(this[n],r);this.length=r},v.prototype.add=function(){var r,n,t,e,i;for(e=0,i=this.subarrays;i>e;++e)if(r=this.masks[e],n=this.width-32*e,t=~r&-~r,!(n>=32)||t)return 32>n&&t&1<<n&&(this[e]=B(this[e],n<<=1),this.width=32*e+n),this.masks[e]|=t,{offset:e,one:t};return this[this.subarrays]=J(this.length),this.masks[this.subarrays]=1,this.width+=8,{offset:this.subarrays++,one:1}},v.prototype.copy=function(r,n){var t,e;for(t=0,e=this.subarrays;e>t;++t)this[t][r]=this[t][n]},v.prototype.truncate=function(r){var n,t;for(n=0,t=this.subarrays;t>n;++n){for(var e=this.length-1;e>=r;e--)this[n][e]=0;this[n].length=r}this.length=r},v.prototype.zero=function(r){var n,t;for(n=0,t=this.subarrays;t>n;++n)if(this[n][r])return!1;return!0},v.prototype.zeroExcept=function(r,n,t){var e,i;for(e=0,i=this.subarrays;i>e;++e)if(e===n?this[e][r]&t:this[e][r])return!1;return!0},v.prototype.only=function(r,n,t){var e,i;for(e=0,i=this.subarrays;i>e;++e)if(this[e][r]!=(e===n?t:0))return!1;return!0},v.prototype.onlyExcept=function(r,n,t,e,i){var o,u,f;for(u=0,f=this.subarrays;f>u;++u)if(o=this[u][r],u===n&&(o&=t),o!=(u===e?i:0))return!1;return!0},r.crossfilter=A}("undefined"!=typeof exports&&exports||this);